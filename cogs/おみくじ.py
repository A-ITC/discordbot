from discord.ext import commands
import discord
import config
import sys
import asyncio 
import random 
import requests

from discord_slash import cog_ext, SlashContext
from discord_slash.utils.manage_commands import create_option

unsei=["å¤§å‰","å‰","æœ«å‰","å°å‡¶","å‡¶","å¤§å‡¶"]
omi_color=["ğŸŸ¥","ğŸŸ§","ğŸŸ¨","ğŸŸ©","ğŸŸ¦","ğŸŸª"]
color_codes=[0xe23d2e,0xdb740d,0xd5d11d,0x20d017,0x1c74e0,0x4c10c6]
omikujis=[
    (5,"ã‚‚ã†ä½•ã‚‚ã„ã†ã¾ã„"),
    (5,"ä»Šæ—¥æ­»ã«ã¾ã™ã€‚"),
    (5,"ä»Šæ—¥ã¯é‹å‹¢ãŒã‹ãªã‚Šæ‚ªã„ã‚ˆã†ã§ã™ã€‚ä»Šã¾ã§å¾Œå›ã—ã«ã—ã¦ããŸã¤ã‘ãŒå›ã£ã¦ããŸã‚Šã€å¤‰ãªãƒˆãƒ©ãƒ–ãƒ«ã«è¦‹èˆã‚ã‚Œã‚‹ã§ã—ã‚‡ã†ã€‚å¯åŠã«æ°—ã‚’ä»˜ã‘ã‚ˆã†ã€‚"),
    (4,"å°‘ã—èª¿å­ã®æ‚ªã„æ—¥ã«ãªã‚Šãã†ã§ã™ã€‚æ°—åˆ†è»¢æ›ã‚’ãŠã‚¹ã‚¹ãƒ¡ã—ã¾ã™ã€‚"),
    (4,"é‹å‹¢ãŒã¡ã‚‡ã£ã¨ä¸å®‰ã§ã™ã­ã€‚ä¸å®‰ãŒã‚ã‚Œã°å®¶ã§ã‚†ã£ãã‚Šä¼‘ã‚€ã¨ã„ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ãŠè…¹ã‚’å£Šã•ãªã„ã‚ˆã†æ³¨æ„ã€‚"),
    (4,"é€šå­¦ä¸­ã‚¤ãƒ¤ãƒ›ãƒ³ã‚’è½ã¨ã™ç¢ºç‡ãŒä¸ŠãŒã£ã¦ã„ã¾ã™ã€‚"),
    (4,"ã‚ãªãŸã®è¡Œå‹•ãŒä»Šå¾Œå¤§ããªçµæœã‚’å·»ãèµ·ã“ã™ã§ã—ã‚‡ã†ã€‚"),
    (4,"æ—¥å¸¸ç”Ÿæ´»ã«æ”¯éšœã¯ã‚ã¾ã‚Šã‚ã‚Šã¾ã›ã‚“ãŒã€æ§˜å­ã‚’ã¿ã¾ã—ã‚‡ã†ã€‚"),
    (3,"ã“ã‚Œã£ã¦æ‚ªã„ã®ã‹æ‚ªããªã„ã®ã‹å¾®å¦™ãªãƒ©ã‚¤ãƒ³ã§ã™ã‚ˆã­ã€‚"),
    (3,"é‹ã®ã‚ãã‚ŠãŒã‚¢ãƒ¬ãªã“ã¨ã«ãªã£ã¦ã¾ã™ã€‚é ‘å¼µã‚Œã€‚"),
    (3,"å®‰é™ã«ã—ã¦ã¦ãã ã•ã„ã€‚"),
    (2,"å°å‰ã¨æœ«å‰ã£ã¦ã©ã£ã¡ãŒè‰¯ã„ã‚“ã§ã™ã‹ã€‚"),
    (2,"ç‰¹ã«ã„ã†ã“ã¨ã®ãªã„å¹³å‡¡ãªé‹å‹¢ã§ã™ã€‚ã§ã‚‚ä½•ã‚‚èµ·ã“ã‚‰ãªã„ã“ã¨ãŒå¹¸ã›ãªã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚"),
    (2,"ç„¡ãã—ã‚‚ã®ã«æ³¨æ„ã€‚æ¢ã™ã®ã‚’ã‚„ã‚ãŸã¨ãè¦‹ã¤ã‹ã‚‹ã“ã¨ã‚‚ã‚ˆãã‚ã‚‹è©±ã§ã™ã€‚"),
    (2,"ãƒ•ãƒ«ãƒ¼ãƒ„ã§ã‚‚é£Ÿã¹ã¦å…ƒæ°—ã ã—ã¾ã—ã‚‡ã†ã€‚å¥åº·ãŒã„ã¡ã°ã‚“"),
    (1,"ãƒ©ãƒƒã‚­ãƒ¼ãªä¸€æ—¥ãŒè¨ªã‚Œã¾ã™ã€‚æ™®æ®µé€šã‚‰ãªã„é“ã‚’é€šã‚‹ã¨æ€ã‚ã¬ç™ºè¦‹ãŒã‚ã‚‹ã‹ã‚‚ã€‚"),
    (1,"è‰¯ã•ã’ãªæ—¥ã«ãªã‚Šãã†ã§ã™ã€‚"),
    (1,"ä»Šæ—¥ã¯ãƒ©ãƒƒã‚­ãƒ¼ã«ãªã‚Šãã†ãªäºˆæ„Ÿï¼å¤–ã‚’æ­©ãã¨æ–°ã—ã„ç™ºè¦‹ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚"),
    (1,"ã‚¢ã‚¤ã‚¹ã‚’è²·ã†ã¨ã‚‚ã‚ŒãªããŠã¾ã‘ãŒã¤ã„ã¦ãã‚‹ã€‚"),
    (1,"ä»Šæ—¥ã¯ãœã„ãŸãã‚’ã™ã‚‹ã¨ãªã«ã‚„ã‚‰ã„ã„ã“ã¨ãŒèµ·ã“ã‚Šãã†ã§ã™ï¼"),
    (0,"ä»Šæ—¥ã¯é‹ã¨ã„ã†é‹ãŒã‚ãªãŸã‚’å‘³æ–¹ã—ã¦ã„ã¾ã™ã€‚è¡—ä¸­ã‚’æ­©ãã ã‘ã§å¤©å¤‰åœ°ç•°ãŒèµ·ã“ã‚‹å‹¢ã„ã§ã—ã‚‡ã†ã€‚"),
    #(-1,"400","Bad request"),
    #(-1,"403","Forbidden"),
    #(-1,"404","Not found"),
    #(-1,"408","Request timeout"),
    #(-1,"500","Internal server error"),
    #(-1,"502","Bad gateway"),
    #(-1,"Sorry! :(","This page has been deleted."),
    #(-1,"Segementation fault","internal error"),
    ]
rucky_items=[
    ("ãƒªãƒ³ã‚´","ç”˜é…¸ã£ã±ã„å‘³ãŒè„³ã‚’åˆºæ¿€ã—ã€æŸ”è»Ÿãªç™ºæƒ³ãŒå¾—ã‚‰ã‚Œã‚‹ã‹ã‚‚"),
    ("ã‚«ãƒ¬ãƒ¼","é£Ÿæ¬²ã‚’ããã‚‹ã‚¹ãƒ‘ã‚¤ã‚¹ã®é¦™ã‚ŠãŒæ°—åˆ†è»¢æ›ã«ã„ã„ã‹ã‚‚ï¼Ÿç•°å›½æƒ…ç·’ã‚’å‘³ã‚ãŠã†ï¼"),
    ("åœ°çƒ","æ¯ãªã‚‹å¤§åœ°"),
    ("ç„¡",""),
    ("ãƒ†ãƒ³ã‚­ãƒ¼","æŒã¡æ­©ãã¨æ„å¤–ãªã¨ã“ã‚ã§å½¹ã«ç«‹ã¤ã‹ã‚‚ï¼Ÿ"),
    ("ãƒ”ãƒ¼ãƒŠãƒƒãƒ„","ãƒŸãƒãƒ©ãƒ«ã‚’è£œçµ¦ã™ã‚‹ã“ã¨ã§ã†ã‚“ã¬ã‚“ã‹ã‚“ã¬ã‚“"),
    ("ä¿¡å·æ©Ÿ","ä¸‰è‰²ã®è‰²é®®ã‚„ã‹ãªå…‰ãŒã‚ãªãŸã‚’ç…§ã‚‰ã—ã¦ãã‚Œã¾ã™"),
    ("ã‚µãƒ©ãƒ€ãƒã‚­ãƒ³","ãƒ˜ãƒ«ã‚·ãƒ¼ã§ãŠã„ã—ã„"),
    ("ç‚­é…¸æ°´","è‰²ã€…ãªã‚‚ã®ã¨æ··ãœã‚‹ã¨ã‚ˆã‚ŠåŠ¹æœçš„"),
    ("ãƒ©ãƒ¼ãƒ¡ãƒ³","ã¨ã‚“ã“ã¤ã‚¹ãƒ¼ãƒ—ã‚’é£²ã¿ã‚ã£ãŸã¾ã‚‹ã¨ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã§ãã¾ã™ã€‚"),
    ("ã‚¨ã‚¹ã‚«ãƒ«ã‚´","ã‚µã‚¤ã‚¼ãƒªãƒ¤ã«ã‚ã‚‹ã‚„ã¤"),
    ("ãƒã‚¤ã‚¯ã‚¹ã‚¿ãƒ³ãƒ‰","é éš”æˆæ¥­ã«å‚™ãˆã¦éŸ³éŸ¿æ©Ÿæã‚’æ•´ãˆã‚ˆã†ï¼"),
    ("???","ãˆã£â€¦ï¼Ÿ"),
    ("ã‚¤ãƒ³ãƒ‰æ˜ ç”»","è¸Šã‚Šã‚’è¦‹ã¦æ°—åˆ†ã‚’å¤‰ãˆã¾ã—ã‚‡ã†"),
    ("ãƒ¨ã‚¬","é‹å‹•ã‚’ã™ã‚‹ã“ã¨ã§ã‚¹ãƒˆãƒ¬ã‚¹ã‚’ç™ºæ•£ã—ã¦ã¿ã¾ã—ã‚‡ã†"),
    ("ã¿ãŸã‚‰ã—å›£å­","ã‚¹ã‚¤ãƒ¼ãƒ„ãŠã„ã—ã„"),
    ("é¦¬","ä¹—ã‚‹ã‚‚ã‚ˆã—ã€è³­ã‘ã‚‹ã‚‚ã‚ˆã—"),
    ("ãƒœãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ","å¤§å‹¢ã§éŠã‚“ã§ãã ã•ã„ã€‚"),
]
class Omikuji(commands.Cog):
    def __init__(self,bot):
        self.bot=bot
                
    @commands.command()
    async def ãŠã¿ãã˜(self,ctx):

        # å—ã‘å–ã£ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å†…å®¹ã‚’ä½¿ã£ã¦è¿”ä¿¡
        embed = discord.Embed(title=f"ãŠã¿ãã˜")
        # Embed ã®è¡¨ç¤ºè‰²ã‚’é’è‰²ã«è¨­å®š
        omikuj=random.choice(omikujis)
        item=random.choice(rucky_items)
        omi_num=omikuj[0]
        if omi_num==-1:
            embed.color = 0x777777
            embed.add_field(name=f"ã‚ãªãŸã®é‹å‹¢ã¯â€¦", value=f"{omikuj[1]}\n{omikuj[2]}",inline=False)
        else:
            embed.color = color_codes[omi_num]
            embed.add_field(name=f"ã‚ãªãŸã®é‹å‹¢ã¯â€¦", value=f"{omi_color[omi_num]}{unsei[omi_num]}{omi_color[omi_num]}\n{omikuj[1]}",inline=False)
            embed.add_field(name="ãƒ©ãƒƒã‚­ãƒ¼ã‚¢ã‚¤ãƒ†ãƒ ",value=f"**{item[0]}** {item[1]}",inline=False)
            embed.set_thumbnail(url=f"https://www.ed.tus.ac.jp/tusitclub/discord/om{omi_num}.png")
        async with ctx.channel.typing():
            await ctx.reply(embed=embed)

    @cog_ext.cog_slash(name="ãŠã¿ãã˜",  description= "ãŠã¿ãã˜ã‚’ã²ãã¾ã™ã€‚",guild_ids=config.guild_ids)
    async def _ãŠã¿ãã˜(self,ctx):
        # å—ã‘å–ã£ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å†…å®¹ã‚’ä½¿ã£ã¦è¿”ä¿¡
        embed = discord.Embed(title=f"ãŠã¿ãã˜")
        # Embed ã®è¡¨ç¤ºè‰²ã‚’é’è‰²ã«è¨­å®š
        omikuj=random.choice(omikujis)
        item=random.choice(rucky_items)
        omi_num=omikuj[0]
        if omi_num==-1:
            embed.color = 0x777777
            embed.add_field(name=f"ã‚ãªãŸã®é‹å‹¢ã¯â€¦", value=f"{omikuj[1]}\n{omikuj[2]}",inline=False)
        else:
            embed.color = color_codes[omi_num]
            embed.add_field(name=f"ã‚ãªãŸã®é‹å‹¢ã¯â€¦", value=f"{omi_color[omi_num]}{unsei[omi_num]}{omi_color[omi_num]}\n{omikuj[1]}",inline=False)
            embed.add_field(name="ãƒ©ãƒƒã‚­ãƒ¼ã‚¢ã‚¤ãƒ†ãƒ ",value=f"**{item[0]}** {item[1]}",inline=False)
            embed.set_thumbnail(url=f"https://www.ed.tus.ac.jp/tusitclub/discord/om{omi_num}.png")
        async with ctx.channel.typing():
            await ctx.send(embed=embed)
        
def setup(bot):
    bot.add_cog(Omikuji(bot))